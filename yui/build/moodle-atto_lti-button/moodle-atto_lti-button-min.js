YUI.add("moodle-atto_lti-button",function(l,t){l.namespace("M.atto_lti").COMPONENTNAME="atto_lti",l.namespace("M.atto_lti").Button=l.Base.create("button",l.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"icon",iconComponent:"atto_lti",callback:this._displayDialogue,tags:".lti-placeholder",tagMatchRequiresAll:!1,inlineFormat:!0,keys:"66"}),this.editor.all(".lti-placeholder").setAttribute("contenteditable","false")},_displayDialogue:function(){var e=this.getDialogue({headerContent:M.util.get_string("pluginname",l.M.atto_lti.COMPONENTNAME),width:"auto",focusAfterHide:!0}),a=this;l.M.atto_lti.Dialogue.setDialogueContent(this,function(t){e.set("bodyContent",t).show(),M.form.shortforms({formid:a.get("host").get("elementid")+"_atto_lti_form"}),t.one("."+l.M.atto_lti.CSS_SELECTORS.INPUTSUBMIT).on("click",function(t){t.preventDefault(),a._setLTI(1)},this)})},_getLTIDiv:function(){var t=this.get("host").getSelectedNodes(),e=null;return t.each(function(t){t.hasClass("lti-placeholder")&&(e=t)}),e},_setLTI:function(a){var i,t=this._getLTIDiv(),o=this.get("host");o.focus(),t&&t.remove(),i=this,require(["core/ajax","core/notification"],function(t,e){t.call([{methodname:"atto_lti_fetch_param",args:{typeid:a,instanceid:12345}}])[0].then(function(t){var e=l.Handlebars.compile(l.M.atto_lti.LTI_TEMPLATE),t=e(t);o.insertContentAtFocusPoint(t),i.markUpdated()})["catch"](e.exception)})}},{ATTRS:{langs:{value:["Default","Value"]}}}),l.namespace("M.atto_lti").Dialogue={setDialogueContent:function(a,i){require(["core/ajax","core/notification"],function(t,e){return t.call([{methodname:"mod_lti_get_tool_types",args:{}}])[0].then(function(t){var e=l.Handlebars.compile(l.M.atto_lti.FORM_TEMPLATE),t=l.Node.create(e({elementid:a.get("host").get("elementid"),CSS:l.M.atto_lti.CSS_SELECTORS,component:l.M.atto_lti.COMPONENTNAME,ltitypes:t}));i(t)})["catch"](e.exception)})}},l.namespace("M.atto_lti").LTI_TEMPLATE='{{#if addParagraphs}}<p><br></p>{{/if}}<div class="lti-placeholder" contenteditable="false"><iframe id="contentframe" height="600px" width="100%" src="{{launchurl}}" allow="microphone {{ltiallowurl}}; camera {{ltiallowurl}}; geolocation {{ltiallowurl}}; midi {{ltiallowurl}}; encrypted-media {{ltiallowurl}}; autoplay {{ltiallowurl}} " allowfullscreen="1"><div class="att-lti-login-info">{{#loginparameters}}<div class="d-none" data-name="{{key}}" data-value="{{value}}"></div> {{/loginparameters}}</div></iframe></div>{{#if addParagraphs}}<p><br></p>{{/if}}',l.namespace("M.atto_lti").FORM_TEMPLATE='<form class="atto_form mform" id="{{elementid}}_atto_lti_form"><fieldset>{{#ltitypes}}<input type="radio" id="{{id}}-{{name}}" name="{{name}}" value="{{id}}"><label for="{{id}}-{{name}}">{{name}}</label>{{/ltitypes}}<div class="text-center"><button class="btn btn-secondary {{CSS.INPUTSUBMIT}}" type="submit">{{get_string "pluginname" component}}</button></div></fieldset></form>',l.namespace("M.atto_lti").CSS_SELECTORS={INPUTSUBMIT:"atto_lti_entrysubmit"}},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});